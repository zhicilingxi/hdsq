<style>
.left{ float:left}
.right{ float:right !important}
.index-bm {
width: 200px;
margin-right: -590px;
background: url(__PUBLIC__/images/Home/ksbjBg.png) center 20px no-repeat;
padding: 81px 20px 30px;
z-index: 2;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td.radioNew .newHouse{
	width:90px!important;
	height: 30px;
	line-height: 30px;
	color: #999999;
	font-size: 12px;
	font-family:"微软雅黑";
	display: inline-block;
	cursor: pointer;
	background: #fff;
}
td.radioNew{
	/*width:93px!important;*/
	width:90px;
	*width:90px;
	height: 30px;
	/*background: #fff;*/
	float: left;
	margin-bottom: 10px;
	/*border:1px solid #dbdbdb;*/
	line-height: 30px;
	color: #999999;
	font-size: 12px;
	font-family: "微软雅黑";
/*	display: inline-block;*/
	text-indent: 10px;
	cursor: pointer;
	margin-bottom:10px;
}
/* td.active {
border: 1px solid #fa4c06;
color: #fa4c06;
width:90px!important;
background: url(http://www.sc.cc/public/web/2016/images/checked.png) no-repeat 70% center;
} */
td.active span.newHouse{
color: #fa4c06;
border: 1px solid #fa4c06;
color: #fa4c06;
width:90px!important;
background:#fff url(http://www.sc.cc/public/web/2016/images/checked.png) no-repeat 70% center;	
}
.index-input-03{ width:208px; padding-left:10px; height:30px; border:#dbdbdb solid 1px; line-height:30px;color: #000000;box-sizing:border-box;}
#area{background:#fff  url(__PUBLIC__/images/Home/mjBg.png) no-repeat 95% center;}
.index-button-02{ width:208px; height:32px; background:#fa4c06; color:#ffffff; text-align:center; line-height:32px; cursor:pointer; font-size:18px;border:none;}
.index-button-02:hover{  background:#cc0000; }
.index-advertising{ padding:20px 0px; background:#ebebeb;}
.advertising-con{ border-bottom:#cccccc 2px solid; padding-bottom:5px;}
.advertising-con h3{ font-size:48px; color:#fa4c06; font-weight:600; width:260px; height:50px; overflow:hidden}
.advertising-con span{ width:920px ; height:51px;}
.index-box1{ background:url(http://www.sc.cc/public/web/2016/images/index-box-bg1.jpg) center top no-repeat; height:auto; padding-top:10px;padding-bottom:20px;}
.box{ width:350px; height:265px; margin:17px 20px 30px 0px; padding:115px 15px 0px; display:inline}
.box-1{ background:url(http://www.sc.cc/public/web/2016/images/index-box-1.jpg) center top no-repeat;}
.box p{ line-height:26px; width:350px;}
.box b{ width:27px; height:27px; background:#ff0000; color:#ffffff; display:block; text-align:center; border-radius:50%}
.box p span{ color:#ffff00}
.box-2{ background:url(http://www.sc.cc/public/web/2016/images/index-box-2.jpg) center top no-repeat;}
.box-3{ background:url(http://www.sc.cc/public/web/2016/images/index-box-3.jpg) center top no-repeat; margin-right:0px !important; }
.banner-silder{ position:absolute; left:0px; top:0px; width:100%; height:400px;}
.banner{ height:400px;}
.index-input-dx,.index-input-btn{ width:90px; height:30px; line-height:30px; display:block; text-align:center}
.index-input-btn{ background:#fa4c06 !important; color:#ffffff; cursor:pointer; border:none}
.bj-tr{ width:200px; float:left; display:inline}
#radioOld{ float:right !important}
.bj-td{ float:left; width:90px !important;}

.index-input-btn-false{ width:90px; height:30px; line-height:30px; display:block; text-align:center;background:#ccc !important; color:#999; cursor:pointer}
</style>
<div class="index-bm" id="index_bm"> 
			<form class="rightform1" method="post" novalidate="novalidate">
				<table border="0" cellspadding="0" cellspacing="0" style="table-layout:fixed">
						<tbody><tr>
							<td height="45" colspan="2" width="100%"><input type="text" class="index-input-03" placeholder="请输入您的姓名" id="name" name="name"></td>
						</tr>
						
						<tr>
							<td height="45" colspan="2"><input type="text" class="index-input-03" placeholder="请输入您的房屋面积" id="area" name="area"></td>
						</tr>
						<tr>
							<td  height="42" class="radioNew active" ><span class=" newHouse left" id="old1" name="0">新房</span></td>
							<td  height="42" class="radioNew"  id="radioOld"><span class=" newHouse right" id="old2" name="0">老房</span></td>
						</tr>
                        <tr>
							<td height="45" colspan="2" width="100%"><input type="text" maxlength="11" class="index-input-03" placeholder="请输入您的手机" id="phone" name="phone"></td>
						</tr>
                         <tr>
                          <td height="40" class="bj-td"><input type="text"  name="checkCode" size="4" maxlength="4"  class="index-input-dx left" placeholder="请输入验证码"/></td>
                          <td  height="40" class="bj-td" id="radioOld"><input type="button" name="yanCode" onclick="bjyzm(this)" class="index-input-btn right" value="获取验证码" /></td>
                        </tr>
						<!--<tr>
							<td  height="45" class="radioNew " ><div class="newHouse left" id="old1" name="0">新房</div></td>
							<td  height="45" class="radioNew "  id="radioOld"><div class="newHouse right" id="old2" name="0">老房</div></td>
						</tr>-->
                     
						<tr>
							<td height="45" colspan="2" width="100%">
							<input type="button" id="sm1" onclick="bjbaoming(this)" class="index-button-02 all-hover-animate" value="获取报价" 
							<if condition="$vo['image'] ==''">
						    <else /> 
								style="background:url({$vo['image']});"
							</if>
							>
							</td>
						</tr>
					</tbody></table>
					<input type="hidden" value="" name="PromoterId">
					<input type="hidden" value="" name="PromoterName">
				</form>     
				</div>
	
<script src="__JS__/jquery.validate.js" type="text/javascript"></script>
<script src="__JS__/jquery-ui.min.js"></script>
<link rel="stylesheet" media="screen" href="__CSS__/jquery-ui.min.css">
<script>
//发送手机验证码
var isbm = 0;
var checks = '.checkCode';
function bjbaoming(){
	isbm = 1;
	 $('#checkCode').removeClass('checkCode');
	$('.rightform1').submit();
}

function bjyzm(){
	isbm = 0;
	 $('#checkCode').removeClass('checkCode');
	 $('#checkCode').addClass('checkCode');
	
	 $('.rightform1').submit();
	var name =$.trim($('input[name="name"]').val());
	var area =$.trim($('input[name="area"]').val());
	var phone =$.trim($('input[name="phone"]').val());
	if(!name) {
		return ;
		
	}
	if(!area){
		return ;
		
	} 
	if(!phone){
		 return ;
		
	}
	var codeNum=0;
	
			
		$.ajax({
			type: "post",
			url: "{:C('scurl')['COUNTPRICE_MCODE']}",
			data: {phone:phone},	
			dataType: "json",
			success: function(data){
				if(data==1){
				          	$('input[name="yanCode"]').attr('onclick',' ');
				          	timmer=setInterval(codeTime,1000);
				          	$('input[name="yanCode"]').prop('class','index-input-btn-false right');
				}else{	
				         return false;
				}
			}
		})
	
	

	function codeTime(){
		codeNum++;
		$('input[name="yanCode"]').val((30-codeNum)+'秒后发送！');
		if(codeNum>30){
			$('input[name="yanCode"]').prop('class','index-input-btn right');
			$('input[name="yanCode"]').attr('onclick','bjyzm(this)');
			codeNum=0;
			clearInterval(timmer);
			$('input[name="yanCode"]').val("获取校验码");
			   //alert('哈哈！验证码收到没？没收到继续获取哦！！！')
		};
	};//codeTi

}



$("#index_bm td.radioNew").click(function(){
	$('.newHouse').attr('name',0);
	$(this).find('.newHouse').attr('name', 1);
	$(this).addClass("active").siblings().removeClass("active");

});

function bmcg(a,b,c)
{
	var diag = new Dialog();
	diag.Width = 500;
	diag.Height = 300;
	diag.Title = "获取报价";
	diag.URL = "http://sh.sc.cc/index/bmcg/haohua/"+a+"/jiandan/"+b+"/jingzhi/"+c;
	diag.show();
}

$.validator.setDefaults({
	submitHandler: function() {

	},
	showErrors: function(map, list) {
		// there's probably a way to simplify this
		var focussed = document.activeElement;
		if (focussed && $(focussed).is("input, textarea")) {
			$(this.currentForm).tooltip("close", {
				currentTarget: focussed
			}, true)
		}
		this.currentElements.removeAttr("title").removeClass("ui-state-highlight");
		$.each(list, function(index, error) {
			$(error.element).attr("title", error.message).addClass("ui-state-highlight");
		});
		if (focussed && $(focussed).is("input, textarea")) {
			$(this.currentForm).tooltip("open", {
				target: focussed
			});
		}
	}
});
// 手机号码验证
jQuery.validator.addMethod("isMobile", function(value, element) {
	var length = value.length;
	var mobile = /^1[3|4|5|8|7][0-9]\d{8}$/;
	return this.optional(element) || (length == 11 && mobile.test(value));
}, "请正确填写您的手机号码");

(function() {

	$(".rightform1, .problem").tooltip({
		show: false,
		hide: false
	});
var res_status=0;
$(".rightform1").validate({
	onkeyup:false,
	ignore:'.checkCode',
	submitHandler: function(form){ 
	if(isbm == 0){
		return ;
	}
	var name = $("#name").val();
	var phone = $("#phone").val();
	var area = $("#area").val();
	var old1 = $("#old1").attr('name');
	var old2 = $("#old2").attr('name');
	var cid = "{$cityinfo.ID}";

	var yzm =$.trim($('input[name="checkCode"]').val());


	// $.ajax({
	// 	url: "{:C('scurl')['COUNTPRICE_CHECK_YZM']}",
	// 	type: 'post',
	// 	async: false,
	// 	dataType: 'json',
	// 	data: {yzm: yzm},
	// 	success:function(msg){
	// 		if(msg.status==0){
	// 			return false;
	// 		}else{
	// 			res_status =1;
	// 		}
	// 	}
	// })			
	// if(res_status){	
		$.ajax({    
			type:'post',        
			url:"{:C('scurl')['COUNTPRICE_JISUAN']}",    
			data:{
				name:name,
				phone:phone,
				area:area,
				old1:old1,
				old2:old2,
				cid:cid,
				source:'24'
			},    
			cache:false,    
			dataType:'json',    
			success:function(data){   
				// alert(data);
				ga('send', 'event', 'baojia', 'dianji', 'shouye', 2);
				bmcg(data.haohua, data.jiandan, data.jingzhi);
				$('.index-input-03').val('');
			},

		});  
		//alert("formParam"); 
	// }else{
	// 	return false;
	// 	//alert("formParam");    
	// }   
	},     
	rules: {
		name: "required",
		phone: { 
			required:true, 
			isMobile:true 
		},
		area: {
		  required: true,
		  digits: true,
		},
		checkCode: { 
			required:true, 
			remote: {
				url: "{:C('scurl')['COUNTPRICE_CHECK_YZM']}",     //后台处理程序
				type: "post",               //数据发送方式
				dataType: "json",           //接受数据格式   
            		}
		}

	},
	messages: {
		name: "请输入您的姓名",
		phone: {
			required: "请输入您的联系电话",
			isMobile: "请输入一个有效的联系电话"
		},
		area: {
		  required: '请输入您的面积',
		  digits: '只能输入整数',
		},
		checkCode: { 
			required:'请输入验证码',
		    	remote: "验证码错误"
		},
	}

  });


	


})();
</script>			
				